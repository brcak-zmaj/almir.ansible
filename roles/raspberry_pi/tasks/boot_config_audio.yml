---
# Audio Configuration

- name: Configure audio driver (Pi 4/5)
  ansible.builtin.lineinfile:
    path: "{{ rpi_boot_config_file }}"
    regexp: "^#?dtoverlay="
    line: "dtoverlay={{ rpi_audio_driver }}"
    state: present
  when: rpi_model in ['pi4', 'pi5']

- name: Configure audio driver (Pi 3)
  ansible.builtin.lineinfile:
    path: "{{ rpi_boot_config_file }}"
    regexp: "^#?dtparam=audio="
    line: "dtparam=audio={{ 'on' if rpi_audio_enable | bool else 'off' }}"
    state: present
  when: rpi_model == 'pi3'

- name: Configure PWM audio mode
  ansible.builtin.lineinfile:
    path: "{{ rpi_boot_config_file }}"
    regexp: "^#?dtparam=audio_pwm_mode_output="
    line: "dtparam=audio_pwm_mode_output={{ rpi_audio_pwm_mode }}"
    state: present
